# .rubocop.yml - Конфигурация RuboCop для Rails 8

require:
  - rubocop-rails
  - rubocop-rspec
  - rubocop-performance

AllCops:
  TargetRubyVersion: 3.3
  TargetRailsVersion: 8.0
  NewCops: enable
  SuggestExtensions: false
  Exclude:
    - 'db/**/*'
    - 'bin/**/*'
    - 'config/**/*'
    - 'vendor/**/*'
    - 'node_modules/**/*'
    - 'tmp/**/*'
    - 'log/**/*'
    - 'public/**/*'

# Стиль кода
Style/Documentation:
  Enabled: false

Style/FrozenStringLiteralComment:
  Enabled: true
  EnforcedStyle: always

Style/StringLiterals:
  Enabled: true
  EnforcedStyle: single_quotes

Style/StringLiteralsInInterpolation:
  Enabled: true
  EnforcedStyle: double_quotes

Style/HashSyntax:
  Enabled: true
  EnforcedStyle: ruby19_no_mixed_keys
  EnforcedShorthandSyntax: always

Style/SymbolArray:
  Enabled: true
  EnforcedStyle: brackets

Style/WordArray:
  Enabled: true
  EnforcedStyle: brackets

Style/TrailingCommaInArrayLiteral:
  Enabled: true
  EnforcedStyleForMultiline: no_comma

Style/TrailingCommaInHashLiteral:
  Enabled: true
  EnforcedStyleForMultiline: no_comma

Style/TrailingCommaInArguments:
  Enabled: true
  EnforcedStyleForMultiline: no_comma

# Форматирование
Layout/LineLength:
  Max: 100
  AllowedPatterns: 
    - '^\s*#'
    - 'describe .* do$'
    - 'context .* do$'
    - 'it .* do$'

Layout/IndentationWidth:
  Width: 2

Layout/EmptyLinesAroundClassBody:
  Enabled: true
  EnforcedStyle: no_empty_lines

Layout/EmptyLinesAroundModuleBody:
  Enabled: true
  EnforcedStyle: no_empty_lines

Layout/EmptyLinesAroundMethodBody:
  Enabled: true

Layout/MultilineMethodCallIndentation:
  EnforcedStyle: indented

Layout/ArgumentAlignment:
  EnforcedStyle: with_first_argument

Layout/HashAlignment:
  EnforcedHashRocketStyle: key
  EnforcedColonStyle: key
  EnforcedLastArgumentHashStyle: always_inspect

# Метрики
Metrics/MethodLength:
  Max: 20
  CountAsOne: ['array', 'hash', 'heredoc']

Metrics/ClassLength:
  Max: 150
  CountAsOne: ['array', 'hash', 'heredoc']

Metrics/ModuleLength:
  Max: 150
  CountAsOne: ['array', 'hash', 'heredoc']

Metrics/BlockLength:
  Max: 25
  Exclude:
    - 'spec/**/*'
    - 'test/**/*'
    - 'config/routes.rb'
    - '*.gemspec'
    - 'db/schema.rb'

Metrics/AbcSize:
  Max: 20

Metrics/CyclomaticComplexity:
  Max: 10

Metrics/PerceivedComplexity:
  Max: 10

# Naming
Naming/VariableName:
  EnforcedStyle: snake_case

Naming/MethodName:
  EnforcedStyle: snake_case

Naming/FileName:
  Enabled: true

Naming/PredicateName:
  ForbiddenPrefixes:
    - is_
    - has_
    - have_

Naming/AccessorMethodName:
  Enabled: true

# Rails специфичные правила
Rails:
  Enabled: true

Rails/SkipsModelValidations:
  Enabled: true
  ForbiddenMethods:
    - update_attribute
    - update_column
    - update_columns

Rails/TimeZone:
  Enabled: true
  EnforcedStyle: strict

Rails/Date:
  Enabled: true
  EnforcedStyle: strict

Rails/PluckInWhere:
  Enabled: true

Rails/EnvironmentVariableAccess:
  Enabled: true
  AllowReads: true

Rails/OutputSafety:
  Enabled: true

Rails/UniqBeforePluck:
  Enabled: true
  EnforcedStyle: aggressive

Rails/FilePath:
  Enabled: true
  EnforcedStyle: arguments

Rails/Presence:
  Enabled: true

Rails/Blank:
  Enabled: true

Rails/Present:
  Enabled: true

Rails/RedundantForeignKey:
  Enabled: true

Rails/HasManyOrHasOneDependent:
  Enabled: true

Rails/InverseOf:
  Enabled: true

Rails/BulkChangeTable:
  Enabled: true

Rails/ReversibleMigration:
  Enabled: true

Rails/NotNullColumn:
  Enabled: true

Rails/I18nLocaleTexts:
  Enabled: false

# RSpec специфичные правила
RSpec/ExampleLength:
  Max: 20

RSpec/MultipleExpectations:
  Max: 5

RSpec/NestedGroups:
  Max: 5

RSpec/DescribeClass:
  Enabled: true

RSpec/DescribedClass:
  Enabled: true
  EnforcedStyle: described_class

RSpec/ExpectChange:
  Enabled: true
  EnforcedStyle: block

RSpec/ImplicitExpect:
  Enabled: true
  EnforcedStyle: should

RSpec/MessageSpies:
  Enabled: true
  EnforcedStyle: receive

RSpec/NotToNot:
  Enabled: true
  EnforcedStyle: not_to

# Performance
Performance/CollectionLiteralInLoop:
  Enabled: true

Performance/Count:
  Enabled: true

Performance/Detect:
  Enabled: true

Performance/DoubleStartEndWith:
  Enabled: true

Performance/EndWith:
  Enabled: true

Performance/FlatMap:
  Enabled: true

Performance/MapCompact:
  Enabled: true

Performance/RangeInclude:
  Enabled: true

Performance/RedundantBlockCall:
  Enabled: true

Performance/RedundantMatch:
  Enabled: true

Performance/RedundantMerge:
  Enabled: true

Performance/RegexpMatch:
  Enabled: true

Performance/ReverseEach:
  Enabled: true

Performance/Size:
  Enabled: true

Performance/StartWith:
  Enabled: true

Performance/StringInclude:
  Enabled: true

Performance/StringReplacement:
  Enabled: true

Performance/Sum:
  Enabled: true

Performance/TimesMap:
  Enabled: true

# Bundler
Bundler/DuplicatedGem:
  Enabled: true

Bundler/OrderedGems:
  Enabled: true

# Security
Security/Eval:
  Enabled: true

Security/JSONLoad:
  Enabled: true

Security/MarshalLoad:
  Enabled: true

Security/Open:
  Enabled: true

Security/YAMLLoad:
  Enabled: true

# Lint правила
Lint/AmbiguousOperator:
  Enabled: true

Lint/AmbiguousRegexpLiteral:
  Enabled: true

Lint/DuplicateHashKey:
  Enabled: true

Lint/DuplicateMethods:
  Enabled: true

Lint/EmptyEnsure:
  Enabled: true

Lint/EmptyWhen:
  Enabled: true

Lint/EnsureReturn:
  Enabled: true

Lint/FloatOutOfRange:
  Enabled: true

Lint/MissingSuper:
  Enabled: true

Lint/ShadowingOuterLocalVariable:
  Enabled: true

Lint/UnreachableCode:
  Enabled: true

Lint/UselessAssignment:
  Enabled: true
